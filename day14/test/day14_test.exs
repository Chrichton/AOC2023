defmodule Day14Test do
  use ExUnit.Case

  test "read_input" do
    assert Day14.read_input("sample") == [
             ["O", ".", ".", ".", ".", "#", ".", ".", ".", "."],
             ["O", ".", "O", "O", "#", ".", ".", ".", ".", "#"],
             [".", ".", ".", ".", ".", "#", "#", ".", ".", "."],
             ["O", "O", ".", "#", "O", ".", ".", ".", ".", "O"],
             [".", "O", ".", ".", ".", ".", ".", "O", "#", "."],
             ["O", ".", "#", ".", ".", "O", ".", "#", ".", "#"],
             [".", ".", "O", ".", ".", "#", "O", ".", ".", "O"],
             [".", ".", ".", ".", ".", ".", ".", "O", ".", "."],
             ["#", ".", ".", ".", ".", "#", "#", "#", ".", "."],
             ["#", "O", "O", ".", ".", "#", ".", ".", ".", "."]
           ]
  end

  test "rotate_right" do
    assert Day14.rotate_right([
             ["O", ".", ".", ".", ".", "#", ".", ".", ".", "."],
             ["O", ".", "O", "O", "#", ".", ".", ".", ".", "#"],
             [".", ".", ".", ".", ".", "#", "#", ".", ".", "."],
             ["O", "O", ".", "#", "O", ".", ".", ".", ".", "O"],
             [".", "O", ".", ".", ".", ".", ".", "O", "#", "."],
             ["O", ".", "#", ".", ".", "O", ".", "#", ".", "#"],
             [".", ".", "O", ".", ".", "#", "O", ".", ".", "O"],
             [".", ".", ".", ".", ".", ".", ".", "O", ".", "."],
             ["#", ".", ".", ".", ".", "#", "#", "#", ".", "."],
             ["#", "O", "O", ".", ".", "#", ".", ".", ".", "."]
           ]) == [
             ["#", "#", ".", ".", "O", ".", "O", ".", "O", "O"],
             ["O", ".", ".", ".", ".", "O", "O", ".", ".", "."],
             ["O", ".", ".", "O", "#", ".", ".", ".", "O", "."],
             [".", ".", ".", ".", ".", ".", "#", ".", "O", "."],
             [".", ".", ".", ".", ".", ".", "O", ".", "#", "."],
             ["#", "#", ".", "#", "O", ".", ".", "#", ".", "#"],
             [".", "#", ".", "O", ".", ".", ".", "#", ".", "."],
             [".", "#", "O", ".", "#", "O", ".", ".", ".", "."],
             [".", ".", ".", ".", ".", "#", ".", ".", ".", "."],
             [".", ".", ".", "O", "#", ".", "O", ".", "#", "."]
           ]
  end

  test "move_os_right" do
    assert Day14.move_os_right(["O", ".", ".", "O", "#", ".", ".", ".", "O", "."]) ==
             [".", ".", "O", "O", "#", ".", ".", ".", ".", "O"]
  end

  test "calc_load" do
    assert Day14.calc_load(["#", "#", ".", ".", ".", ".", "O", "O", "O", "O"]) == 7 + 8 + 9 + 10
  end

  test "sample" do
    assert Day14.solve("sample") == 136
  end

  test "solve" do
    assert Day14.solve("star") == 109_098
  end

  @tag timeout: :infinity
  test "star2" do
    assert Day14.solve2("star") == nil
  end
end
